/* zflick.js v@1.6a github.com/funnythingz/zflickjs | mit-license */
var zflickjs=function(a){this.id=document.getElementById(a.id);this.contents=document.getElementById(a.contents);this.col=this.contents.getElementsByClassName(a.col);this.lamp=(a.lamp)?document.getElementById(a.lamp):false;this.btnPrev=(a.btn)?document.getElementById(a.btn.prev):false;this.btnNext=(a.btn)?document.getElementById(a.btn.next):false;this.move=(a.move)?a.move:false;this.autoChange=(a.autoChange)?a.autoChange:false;this.autoTimer=(a.autoTimer)?a.autoTimer:5000;this.cur=(a.cur)?a.cur:0;this.callback=(a.callback)?a.callback:function(){};this.isArgsWidth=(!a.width||a.width<=0)?false:true;this.idWidth=(this.isArgsWidth)?a.width:this.id.clientWidth;this.num=0;this.disX=(!a.disX||a.disX<=0)?15:a.disX;this.length=0;this.carray=[];this.warray=[];this.lamps=[];if(this.autoChange){this.autoChangeFlag=true;this.autoTimerCache=[]}this._cNowPos=0;this._cStartPos=0;this._cDistance=0;this._cHoge=0;this._orien=false;this._btnFlag=(a.btn)?true:false;this._ua=navigator.userAgent;this.init()};zflickjs.prototype={init:function(){this.domInit(this);this.touchInit(this);if(this._btnFlag){this.clickPrevInit(this);this.clickNextInit(this)}this.createLamp(this);this.animation(this);this.resetAutoChange(this)},touchInit:function(b){var a=false;b.contents.addEventListener("touchstart",function(c){b._cStartPos=c.touches[0].clientX;b.killAutoChange(b)},false);b.contents.addEventListener("touchmove",function(c){if(/Android/.test(b._ua)){if(!a){b._cDistance=b._cStartPos-c.touches[0].clientX;b._cHoge=b._cNowPos;if(b.disX<Math.abs(b._cDistance)&&(b._cDistance>0)){c.preventDefault();b._cHoge=b._cNowPos-Math.abs(b._cDistance);b._orien=true;a=true}else{if(b.disX<Math.abs(b._cDistance)&&(b._cDistance<0)){c.preventDefault();b._cHoge=b._cNowPos+Math.abs(b._cDistance);b._orien=false;a=true}}if(a){b.animation(b);b._cDistance=0;b.resetAutoChange(b)}}}else{if(/iP(hone|od|ad)/.test(b._ua)){b._cDistance=b._cStartPos-c.touches[0].clientX;b._cHoge=b._cNowPos;if(b.disX<Math.abs(b._cDistance)&&(b._cDistance>0)){c.preventDefault();b._cHoge=b._cNowPos-Math.abs(b._cDistance);b._orien=true}else{if(b.disX<Math.abs(b._cDistance)&&(b._cDistance<0)){c.preventDefault();b._cHoge=b._cNowPos+Math.abs(b._cDistance);b._orien=false}}b.noTransAnimate(b)}}},false);b.contents.addEventListener("touchend",function(c){a=false;if(/iP(hone|od|ad)/.test(b._ua)){b.animation(b);b._cDistance=0;b.resetAutoChange(b)}},false)},animation:function(a){if(a._orien){if(a.cur<a.length-1){a.cur+=1}else{a.cur=a.length-1}}else{if(a.cur>0){a.cur-=1}else{if(a.cur<=0){a.cur=0}}}a._cNowPos=a.warray[a.cur];a.transAnimate(a);a.btnCurrentAction(a);a.setLamps(a,a.cur)},transAnimate:function(a){if(/AppleWebKit/.test(a._ua)){a.contents.style.webkitTransition="-webkit-transform 0.3s ease-in-out";a.contents.style.webkitTransform="translate3d("+a._cNowPos+"px, 0, 0)"}else{if(/Firefox/.test(a._ua)){a.contents.style.MozTransition="-moz-transform 0.3s ease-in-out";a.contents.style.MozTransform="translate3d("+a._cNowPos+"px, 0, 0)"}}setTimeout(function(){a.callback()},300)},noTransAnimate:function(a){if(/AppleWebKit/.test(a._ua)){a.contents.style.webkitTransition="none";a.contents.style.webkitTransform="translate3d("+a._cHoge+"px, 0, 0)"}else{if(/Firefox/.test(a._ua)){a.contents.style.MozTransition="none";a.contents.style.MozTransform="translate3d("+a._cHoge+"px, 0, 0)"}}},btnCurrentAction:function(a){if(a.id.clientWidth>=a.contents.clientWidth){}else{if(a.cur<=0){if(a._btnFlag){if(a.btnPrev.className.indexOf("zflickBtnCur")>0){a.btnPrev.className=a.btnPrev.className.replace("zflickBtnCur","")}if(a.btnNext.className.indexOf("zflickBtnCur")<0){a.btnNext.className+=" zflickBtnCur"}}}else{if(a.cur===a.length-1){if(a._btnFlag){if(a.btnPrev.className.indexOf("zflickBtnCur")<0){a.btnPrev.className+=" zflickBtnCur"}if(a.btnNext.className.indexOf("zflickBtnCur")>0){a.btnNext.className=a.btnNext.className.replace("zflickBtnCur","")}}}else{if(a._btnFlag){if(a.btnPrev.className.indexOf("zflickBtnCur")<0){a.btnPrev.className+=" zflickBtnCur"}if(a.btnNext.className.indexOf("zflickBtnCur")<0){a.btnNext.className+=" zflickBtnCur"}}}}}},clickPrevInit:function(a){a.btnPrev.addEventListener("click",function(b){a._orien=false;a.animation(a);a.killAutoChange(a);setTimeout(function(){a.resetAutoChange(a)},a.autoTimer+1000)},false)},clickNextInit:function(a){a.btnNext.addEventListener("click",function(b){a._orien=true;a.animation(a);a.killAutoChange(a);setTimeout(function(){a.resetAutoChange(a)},a.autoTimer+100)},false)},resizeInit:function(b){var a=b;var c=false;window.addEventListener("resize",function(){if(c!==false){clearTimeout(c)}c=setTimeout(function(){a.domInit(a);a.animation(a);a.resetAutoChange(a)},200)},false)},domInit:function(a){a.id.style.width="auto";if(!a.isArgsWidth){a.idWidth=a.id.clientWidth}a.length=a.col.length;a.id.style.width=a.idWidth+"px";a.contents.style.width=a.getContentsWidth()+"px";a.resizeInit(a)},createLamp:function(b){if(b.lamp){for(var a=0;a<b.length;a++){b.lamps[a]=document.createElement("div");b.lamp.appendChild(b.lamps[a])}}},setLamps:function(c,a){if(c.lamp){for(var b=0;b<c.length;b++){c.lamps[b].setAttribute("class","")}c.lamps[a].setAttribute("class","cur")}},getContentsWidth:function(){var b=0;for(var d=0,a=this.length;d<a;d++){var e=this.col[d];this.carray[d]=e.offsetWidth;this.warray[d]=-b;b+=e.offsetWidth}return b},autoChangeFunc:function(a){if(!a.autoChangeFlag){a.autoTimerCache.push(setInterval(function(){a.autoChangeFlag=true;if(a.cur===a.length-1){a._orien=false;a.cur=0}else{a._orien=true}a.animation(a)},a.autoTimer))}},resetAutoChange:function(a){if(a.autoChange){a.killAutoChange(a);a.autoChangeFunc(a)}},killAutoChange:function(c){if(this.autoChange){c.autoChangeFlag=false;for(var b=0,a=c.autoTimerCache.length;b<a;b++){clearInterval(c.autoTimerCache[b]);c.autoTimerCache.splice(b,1)}}}};
